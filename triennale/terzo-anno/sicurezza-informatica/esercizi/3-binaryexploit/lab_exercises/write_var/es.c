#include <stdio.h>
#include <string.h>
#include <stdint.h>

char *bash = "/bin/bash";

void vuln(char *src){
    uint32_t control=12345;
    char buf[100];
    strcpy(buf, src);
    printf("control must be: 0x42434445 now is %x\n",control);
    if (control==0x42434445){
        char flag[]="KWZ\\r\"nRsplC|lo/mnGm{wKxm'H;e";
        char key1[]="melis=root";
        char key2[]="uwuNuwuNuwuNuwu";
        for(int i=0;i<strlen(flag);i++){
                flag[i] = flag[i]^key1[i%10]^key2[i%15];
        }

        printf("%s\n",flag);

    }
   if (strlen(src)==99) {
    char* fkflag = "SEC{is_it_the_flag?}";
    printf("%s\n", fkflag);
   }else
   {
    printf("%s\n",src);
   }
}

int main(int argc, char *argv[]){
    vuln(argv[1]);
}
