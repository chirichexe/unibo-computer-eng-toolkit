
# Utilizzo l'opzione -A in tutte le regole per fare in modo che vengano inserite una in seguito all'altra in ordine 

# 1) Consentire qualsiasi traffico sull'interfaccia di loopback: -----
iptables -A INPUT -i lo -j ACCEPT 
iptables -A OUTPUT -o lo -j ACCEPT 

# 2) Consentire il traffico delle connessioni HTTP entranti: -----
iptables -A INPUT -p tcp --dport 80 -j ACCEPT 
iptables -A OUTPUT -p tcp --sport 80 -m state --state ESTABLISHED -j ACCEPT 

# 3) Consentire connessioni SSH uscenti verso la rete host-only 192.168.56.0/24: -----
iptables -A OUTPUT -p tcp -d 192.168.56.0/24 --dport 22 -j ACCEPT 
iptables -A INPUT -p tcp -s 192.168.56.0/24 --sport 22 -m state --state ESTABLISHED -j ACCEPT 

# 4) Bloccare l'inoltro del traffico proveniente dalla rete host-only verso altre destinazioni: -----
iptables -A FORWARD -s 192.168.56.0/24 ! -d 192.168.56.0/24 -j DROP 

----------------NB: spiegazione del comando:----------------------------------
iptables -A FORWARD -s 192.168.56.0/24 ! -d 192.168.56.0/24 -j DROP


Questo comando iptables è utilizzato per bloccare l'inoltro del traffico proveniente dalla rete host-only verso altre destinazioni. 

- `iptables -A FORWARD`: Aggiunge (`A`: append) una regola alla catena `FORWARD`. Questa catena viene utilizzata per gestire il traffico inoltrato attraverso il sistema.

- `s 192.168.56.0/24`: Specifica che la regola si applica al traffico proveniente dalla rete host-only con indirizzi IP nell'intervallo 192.168.56.0/24.

- `! -d 192.168.56.0/24`: Questa parte della regola nega (`!`) il traffico destinato alla rete host-only stessa (192.168.56.0/24). In altre parole, la regola si applica al traffico proveniente dalla rete host-only e diretto a qualsiasi destinazione che non sia la stessa rete host-only.

- `j DROP`: Indica che il traffico corrispondente deve essere scartato (DROP), cioè eliminato senza ulteriori elaborazioni.

In sintesi, questa regola impedisce il passaggio del traffico proveniente dalla rete host-only verso qualsiasi altra destinazione al di fuori di questa stessa rete. Questo può essere utile per isolare la rete host-only e impedire l'accesso ad altre reti o risorse esterne. Assicurati di posizionare questa regola in modo appropriato all'interno della catena `FORWARD` in base alle tue esigenze specifiche e alla configurazione esistente del firewall.
------------------------------------------------------------------------------

# 5) Consentire la risoluzione dei nomi DNS: -----
iptables -A OUTPUT -p udp --dport 53 -j ACCEPT 
iptables -A INPUT -p udp --sport 53 -m state --state ESTABLISHED -j ACCEPT 

# 6) Infine bloccare tutto il traffico non elencato nei punti 2, 3, 5: ---
iptables -P INPUT DROP 
iptables -P OUTPUT DROP 
iptables -P FORWARD ACCEPT 

# notare che l'esclusione della regola 4 deve far dedurre che per il forwarding 
# deve valere un principio di default accept, altrimenti non avrebbe senso la regola 
# che applica a un caso specifico l'azione DROP
