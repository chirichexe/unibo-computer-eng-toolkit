0) Spiegare che differenza c'è tra Suricata in modalita IPS e suricata in modalità IDS. Evidenziare in particolare in quale modalità è stato da noi utilizzato, evidenziandone pregi e svantaggi

Suricata è in grado di eseguire sia rilevamento delle intrusioni in tempo reale (IDS intrusion detection system) che prevenzione delle intrusioni (IPS intrusion protection system). Noi lo abbiamo utilizzato nella modalità IDS anche se ci siamo prevalentemente concentrati in esercitazioni in cui l'elaborazione dei pcap era offline.

1) Scrivere una regola suricata in modalità alert per il traffico icmp SOLTANTO IN ENTRATA sulla rete 192.168.56.X
Prima di tutto è necessario modificare il file /etc/suricata/suricata.yaml. Nello specifico va modificata la variabile HOME_NET in HOME_NET: "[192.168.56.0/24]"

alert icmp any any -> $HOME_NET any (msg:"logged icmp traffic"; itype:8; sid:1009876; rev:1;)

2) Scivere una regola suricata in modalità alert per qualsiasi richiesta che viene eseguita accedendo al portale virtuale.unibo.it

alert dns any any -> any any (msg:"logged dns_query; content:virtuale.unibo.it"; sid:1009877; rev:1;)

3)Ricavare dal file del tracciato in allegato le seguenti informazioni: Protocollo del traffico (non è SSH), I 2 Indirizzi Ip in gioco ( considerate che ovviamente il traffico è in due direzioni ), La/Le porte del protocollo in gioco

Utilizzo wireshark per analizzare il tracciato contenuto nel file .pcapng 
Il protocollo del traffico è ircu, sulla porta 6666
Gli indirizzi ip in gioco sono 192.168.56.1 e 192.168.56.3
Le porte in gioco sono 54968 per 192.168.56.1 e 6666 per 192.168.56.3

Acquisite queste informazioni è necessario scrivere la regola nel file /etc/suricata/rules/seclab.rules
alert tcp 192.168.56.1 54968 -> 192.168.56.3 6666 (msg:"logged ircu traffic"; flow:to_server; sid:1009481; rev:1;)

per far partire l'analisi del file .pcapng con il comando 
sudo suricata -c /etc/suricata/suricata.yaml -r file.pcapng -k none 

il risultato sta nel file eve.json. Utilizziamo jq per parsarlo. Prima filtriamo tutti i pacchetti che hanno atteributo event_type = "alert" e tra quelli filtriamo quelli che possiendono l'attributo payload_printable
cat eve.json | jq 'select(.event_type=="alert") | .payload_printable'

la flag risulta spezzettata su più pacchetti differenti, ricomponendola otteniamo: 
SEC{this_is_the_first_part_this_is_the_second_part_third_part} 
